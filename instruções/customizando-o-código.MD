> **ATEN√á√ÉO**: ESTE DOCUMENTO AINDA EST√Å EM DESENVOLVIMENTO E N√ÉO EST√Å COMPLETO. 

# Customizando o c√≥digo üë®üèΩ‚Äçüíª

√â poss√≠vel alterar os par√¢metros como as datas padr√£o, a quantidade de colunas e tamb√©m a lista do menu suspenso em "Tipo de publica√ß√£o". Para isso basta alterar algumas se√ß√µes espec√≠ficas do c√≥digo. As altera√ß√µes realizadas no c√≥digo n√£o t√™m efeito retroativo.

> Aten√ß√£o: alterar o c√≥digo pode ocasionar em erro caso n√£o feito corretamente, atente-se as instru√ß√µes. Caso algo der errado, basta reverter as altera√ß√µes.

### Alterando as datas padr√£o (f√°cil)

> üü¢ Um conhecimento b√°sico de JavaScript auxiliar√° no processo.

1. Procure pelo seguinte peda√ßo de c√≥digo dentro da fun√ß√£o [NOME]:
    ```JavaScript
    //DATAS BASE DO CALEND√ÅRIO
    let datasBase = [["01/01","Ano Novo", "Felicitar",""], ["08/03","Dia Internacional da Mulher", "Felicitar", ""], ["23/03", "Anivers√°rio de Curitiba", "Felicitar", ""], ["01/04", "Dia da Mentira", "Felicitar",""], ["17/04","P√°scoa","Felicitar",""],["01/05", "Dia Mundial do Trabalho", "Felicitar", ""], ["08/05", "Dia das M√£es", "Felicitar", ""], ["14/08", "Dia dos Pais", "Felicitar", ""], ["07/09", "Dia da Independ√™ncia", "Felicitar", ""], ["15/09", "Dia do cliente", "Felicitar", ""], ["25/12", "Natal", "Felicitar", ""]]
    ```
    - Note que a vari√°vel ```datasBase``` √© um vetor composto por vetores com 4 valores (```["valor", "valor", "valor", "valor"]```).
      -  O primeiro valor refere-se √† data, no estilo DD/MM.
      - O segundo valor refere-se ao nome da Data.
      - O terceiro valor refere-se a que tipo de item da lista suspensa ele pertece.
      - O quarto valor refere-se as observa√ß√µes adicionais.
    - Para adicionar uma nova data, ao final da lista, insira a nova data conforme especificado anteriormente.

### Alterando os itens da lista do menu suspenso (m√©dio)

> üü¢ Um conhecimento b√°sico de JavaScript e Apps Script, √© recomendado.

1. Procure pelo seguinte peda√ßo de c√≥digo dentro da fun√ß√£o [NOME]:
    ```JavaScript
    planilha.getRange(2,3,planilha.getMaxRows()-1,1).setDataValidation(SpreadsheetApp.newDataValidation()
      .setAllowInvalid(true)
      .requireValueInList(["Autopromo√ß√£o", "Felicitar", "Gancho para artigo de blog", "Promo√ß√£o de produto"], true)
      .build());
    ```
2. Altere o trecho de ```.requireValueInList``` inserindo um novo valor, separado por v√≠rgulas e entre aspas duplas:
    ```JavaScript
    //antigo
    .requireValueInList(["Autopromo√ß√£o", "Felicitar", "Gancho para artigo de blog", "Promo√ß√£o de produto"], true)
    
    //novo
    .requireValueInList(["Autopromo√ß√£o", "Felicitar", "Gancho para artigo de blog", "Promo√ß√£o de produto", "NOVO VALOR 1", "NOVO VALOR 2"], true)
    ```
3. Agora v√° em busca do seguinte c√≥digo:
    ```JavaScript
    //FORMATA√á√ÉO CONDICIONAL
    abaAtiva = SpreadsheetApp.getActiveSheet();
    let celulas = abaAtiva.getRange(`C2:C${datasBase.length+1}`)

    let regra1 = SpreadsheetApp.newConditionalFormatRule()
      .whenCellEmpty()
      .setBackground("#F4CCCC")
      .setRanges([celulas])
      .build();

    let regra2 = SpreadsheetApp.newConditionalFormatRule()
      .whenTextContains("Felicitar")
      .setBackground("#fff2cd")
      .setRanges([celulas])
      .build();

    let regra3 = SpreadsheetApp.newConditionalFormatRule()
      .whenTextContains("Promo√ß√£o")
      .setBackground("#dad2e9")
      .setRanges([celulas])
      .build();

    let regra4 = SpreadsheetApp.newConditionalFormatRule()
      .whenTextContains("Gancho")
      .setBackground("#b7e1cd")
      .setRanges([celulas])
      .build();

    let regra5 = SpreadsheetApp.newConditionalFormatRule()
      .whenTextContains("autopromo√ß√£o")
      .setBackground("#c9daf8")
      .setRanges([celulas])
      .build();
    
    let regras = abaAtiva.getConditionalFormatRules();
    regras.push(regra1, regra2, regra3, regra4, regra5);
    abaAtiva.setConditionalFormatRules(regras)
    ```
1. Insira uma nova regra para cada um dos novos valores adicionados. Copie e cole este modelo no c√≥digo:
    ```JavaScript
    let regraX = SpreadsheetApp.newConditionalFormatRule()
      .whenTextContains("NOVO VALOR 1")
      .setBackground("#FF0000")
      .setRanges([celulas])
      .build();
    ```
    - Insira o c√≥digo ap√≥s a regra 5, como no exemplo abaixo:
        ```JavaScript
        [...]

        let regra5 = SpreadsheetApp.newConditionalFormatRule()
          .whenTextContains("autopromo√ß√£o")
          .setBackground("#c9daf8")
          .setRanges([celulas])
          .build();

        let regraX = SpreadsheetApp.newConditionalFormatRule()
          .whenTextContains("NOVO VALOR 1")
          .setBackground("#FF0000")
          .setRanges([celulas])
          .build();
        
        let regras = abaAtiva.getConditionalFormatRules();
        
        [...]
        ```
1. Altere os trechos ```.whenTextContains("NOVO VALOR 1")``` e ```.setBackground("#FF0000")``` pelo nome do novo valor inserido nas etapas anteriores e o c√≥digo HEX da cor que deseja, respectivamente.
    - Cada novo valor inserido nas etapas anteriores necessita que uma nova regra seja adicionada.
1. Salve o c√≥digo.

Pronto, agora todas as novas datas e calend√°rios criados vir√£o acompanhados dessa mudan√ßa!

### Alterando a quandidade de colunas (dif√≠cil)

> ‚õî Aten√ß√£o: Para executar essa altera√ß√£o, √© recomendado ter conhecimento b√°sico de JavaScript e Apps Script. Conhecimentos em Excel VBA n√£o se aplicam.

1. Procure pelo seguinte peda√ßo de c√≥digo dentro da fun√ß√£o [NOME]:
    ```JavaScript
    //DADOS DA PLANILHA
    const CABECALHO = planilha.getRange(1,1)
    const NOME_DA_DATA = planilha.getRange(1,2)
    const TIPO_DE_PUBLICACAO = planilha.getRange(1,3)
    const OBSERVACOES = planilha.getRange(1,4)
    const TODA_PLANILHA = planilha.getRange(1,1,planilha.getMaxRows(),planilha.getMaxColumns())
    const CORPO_PLANILHA = planilha.getRange(2,1,planilha.getMaxRows(),planilha.getMaxColumns())

    CABECALHO.setValue("Data")
      planilha.setColumnWidth(1, 126)
    NOME_DA_DATA.setValue("Nome")
      planilha.setColumnWidth(2, 252)
    TIPO_DE_PUBLICACAO.setValue("Tipo de publica√ß√£o")
      planilha.setColumnWidth(3, 126)
    OBSERVACOES.setValue("Observa√ß√µes")
      planilha.setColumnWidth(4, 252)
    ```